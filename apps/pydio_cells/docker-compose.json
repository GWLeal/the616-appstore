{
    "schemaVersion": 2,
    "$schema": "https://schemas.runtipi.io/v2/dynamic-compose.json",
    "services": [
        {
            "name": "cells",
            "image": "pydio/cells:4.4.16",
            "isMain": true,
            "internalPort": 8080,
            "environment": [
                {
                    "key": "CELLS_DB_DRIVER",
                    "value": "mysql"
                },
                {
                    "key": "CELLS_DB_HOST",
                    "value": "mysql:3306"
                },
                {
                    "key": "CELLS_DB_USER",
                    "value": "pydio"
                },
                {
                    "key": "CELLS_DB_PASSWORD",
                    "value": "pydio-pass"
                },
                {
                    "key": "CELLS_DB_NAME",
                    "value": "cells"
                },
                {
                    "key": "CELLS_SITE_EXTERNAL",
                    "value": "https://${APP_DOMAIN}"
                },
                {
                    "key": "CELLS_SITE_NO_TLS",
                    "value": "1"
                }
            ],
            "volumes": [
                {
                    "hostPath": "${APP_DATA_DIR}/cellsdir",
                    "containerPath": "/var/cells"
                }
            ],
            "dependsOn": ["mysql"]
        },
        {
            "name": "mysql",
            "image": "mysql:8",
            "environment": [
                {
                    "key": "MYSQL_ROOT_PASSWORD",
                    "value": "pydio-pass"
                },
                {
                    "key": "MYSQL_DATABASE",
                    "value": "cells"
                },
                {
                    "key": "MYSQL_USER",
                    "value": "pydio"
                },
                {
                    "key": "MYSQL_PASSWORD",
                    "value": "pydio-pass"
                }
            ],
            "command": [
                "mysqld",
                "--character-set-server=utf8mb4",
                "--collation-server=utf8mb4_unicode_ci"
            ],
            "volumes": [
                {
                    "hostPath": "${APP_DATA_DIR}/data",
                    "containerPath": "/var/lib/mysql"
                }
            ]
        }
    ]
}
